
# LDAP Notes

## 简述
LDAP 是轻量级目录访问协议，应用场景为大规模搜索场景，没有很好的更新和聚合操作。
LDAP 基于TCP/IP协议或者其他的面向连接的传输服务。基于X.500协议

### X.500 

X.500 由ITU-T 和 ISO 定义，它实际上不是一个协议，而是由一个协议簇组成，包括 X.501 到 X.525 等一系列非常完成的目录服务协议。
    
从技术上说，LDAP 是一个到 X.500 服务的目录方位协议，X.500 是一个 OSI 录服务。最初 LDAP 客户端通过网关访问 X.500 目录服务，网关在客户端和网关之间运行 LDAP ,而 X.500 目录方位协议位于这个网关和 X.500 服务器之间。

DAP 是一个重量级的协议，在整个 OSI 协议上进行操作，并且需要占用大量的计算资源 
LDAP 被设计为在 TCP/IP 层操作，以最小代价实现大多数的 DAP 的功能。

单独的 LDAP 守护程序 openldap(slapd),可以被看作是一个轻量机的 X.500 目录服务器，也就是说它没有实现 X.500 完整的 DAP 协议。作为一个轻量级的目录读物，slapd 实现的仅仅是 X.500 模型的一个子集。

X.500 的主要特征：
+ 分散维护： 运行 X.500 的每个站点只负责本地目录部分，可以进行更新和维护操作。
+ 搜索性能： X.500 具有强大的搜索功能，支持用户建立的任意复杂查询。
+ 单一全局命名空间： 类似于 DNS, X.500 为用户提供单一同性命名空间。于 DNS 相比具有更灵活且易于扩展。
+ 结构化信息结构： X.500 目录中定义了信息结构，允许本地扩展。
+ 基于标准的目录服务： 由于 X.500 被用于建立一个基于标准的目录，因此某种意义上，请求应用目录信息的应用能访问重要且由价值的信息。 

### LDAP 于X.500 相同点

LDAP 是 X.500 标准的目录访问协议 DAP 的一个子集，可用于建立 X.500 目录，因此有许多的相同之处：
1. 在平台上都实现了一个通用的平台结构，提供了一个操作系统和应用程序需要的信息服务类型，可以被许多平台和应用程序接收和实现。
2. 在信息模型上，都是用了项、对象类、属性等概念和模式来描述信息。
3. 在命名控件方面，都是用了目录信息树结构和层次命名模型。
4. 在功能模型上，都是用了相似的操作命令来管理目录信息。
5. 再认证架构方面，都可以实现用户名称和密码或者基于安全加密方式的认证机制。
6. 在灵活性上，它们的目录规模可大可小，大到全球目录树，小到只有一台目录服务器。
7. 在分布性方面，目录信息都可以分布在多个目录服务器中，这些服务器可以由各组织管理，既保证目录信息总体结构的一致性，又满足了分级管理的需要。

### LDAP 于 X.500 不同点

1. LDAP 基于 TCP/IP 协议，X.500 基于 OSI 协议。
2. LDAP 协议更为简单。只保留常用的特性。
3. LDAP 通过引用机制实现分布式访问，X.500 DSA 通过服务器之间的链式操作实现分布式访问，这样查询的压力集中于服务器端；而 LDAP 通过客户端 API 实现分布式操作，平衡负载。
4. LDAP 实现具有低费用、易配置和易管理的特点，经过性能测试， LDAP 比 X.500 具有更少的效应时间，LDAP 提供了满足应用程序对目录服务所需要的特性。

### LDAP 的目录结构

LDAP 目录服务是通过目录数据库来存储网络信息，方便用户迅速查找华人定位，目录数据库是以目录信息树（directory nformation tree, 缩写为DIT）为存储方式的树形存储结构.

LDAP 安装树形结构组织，DIT 主要进行读操作的数据库

DIT 由条目（entry）组成，条目相当于关系数据库中的表的记录；

条目是具有分辨名DN(Distinguished Name)的属性-值对（attribute value,简称AV）的集合.

在UNIX 文件系统中，最顶层是跟目录（root）， LDAP 目录通常也用 root 作为跟目录，通常称为BaseDB.

因为历史（X.500）的原因，LDAP 目录用 OU (Organization Unit) 从逻辑上把数据分开， Ou也是一种条目----容器条目，Ou 的下面才是真正的用户条目。

## LDAP 目录结构相关术语

DN 分辨名（distinguished Name）

在LDAP 中，一个条目的分辨名叫做“DN”,DN 是该条目在整个树中的唯一名称标识，DN 相当于关系数据库表中的关键字（primary key）：它是一个识别属性，通常用于检索。

**DN 的两种设置**

基于cn (姓名)，最常见的 cn 是从`/etc/group` 中转出来的条目。

基于 uid(user ID), 常见的uid 是`/etc/passwd` 转来的条目。

**Base DN**

LDAP 目录树的最顶部就是根，也就是 Base DN。

**LDIF 格式** 

LDIF 格式是用于 LDAP 数据导入、导出的格式， LDIF 是 LDAP 数据库信息的一种文本格式。


